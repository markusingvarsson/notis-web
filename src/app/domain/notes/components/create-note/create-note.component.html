<div
  class="bg-[var(--tw-bg-light)] border border-[var(--tw-border-light)] rounded-2xl shadow-lg overflow-hidden"
>
  <div
    class="border-b border-[var(--tw-border-light)] px-2 sm:px-8 py-4 sm:py-6 transition-all duration-500"
    [class]="headerClasses()"
  >
    <div class="flex items-center gap-4">
      @if (showBackButton()) {
      <button
        type="button"
        class="group flex items-center justify-center w-10 h-10 text-sm font-medium text-[var(--tw-primary-dark)] bg-white/90 border border-[var(--tw-border-light)] rounded-full hover:bg-white hover:shadow-sm hover:border-[var(--tw-border)] focus:outline-none focus:ring-2 focus:ring-[var(--tw-primary)]/20 transition-all duration-200 active:scale-95"
        (click)="backClick.emit()"
      >
        <app-icon-chevron
          [size]="18"
          [color]="'var(--tw-primary-dark)'"
          [orientation]="'left'"
        />
      </button>
      }
      <div class="flex-1">
        <h1
          class="text-2xl font-bold transition-all duration-300"
          [class]="titleClasses()"
        >
          {{ headerTitle() }}
        </h1>
      </div>

      <!-- Action Icons -->
      @if (isSaving()) {
      <div class="flex gap-2">
        <button
          (click)="clearRecording()"
          class="flex items-center justify-center w-10 h-10 rounded-full border border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300 transition-colors duration-150 ease-in-out"
          title="Delete recording"
        >
          <app-trash-icon [size]="20" />
        </button>
        <button
          (click)="handleSave()"
          class="flex items-center justify-center w-10 h-10 rounded-full bg-[var(--tw-primary)] text-white hover:bg-[var(--tw-primary-light)] transition-colors duration-150 ease-in-out"
          title="Save note"
        >
          <app-save-icon [size]="20" />
        </button>
      </div>
      }
    </div>
    @if (isSaving()) {
    <div class="mt-4">
      <div class="h-1 bg-[var(--tw-border-light)] rounded-full overflow-hidden">
        <div
          class="h-full bg-gradient-to-r from-[var(--tw-primary)] to-[var(--tw-success)] rounded-full animate-pulse"
          style="width: 100%; animation: progress 2s ease-in-out infinite"
        ></div>
      </div>
    </div>
    }
  </div>
  <div class="p-2 sm:p-8">
    <app-create-audio-note
      #audioNoteComponent
      (noteCreated)="noteCreated.emit($event)"
      [availableTags]="availableTags()"
    ></app-create-audio-note>
  </div>
</div>
