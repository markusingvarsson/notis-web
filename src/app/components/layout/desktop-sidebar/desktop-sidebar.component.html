<aside
  class="hidden md:flex flex-col w-80 bg-white/80 backdrop-blur-lg border-r border-gray-200/50 h-screen fixed left-0 top-0 z-40"
>
  <!-- Header -->
  <div class="flex items-center gap-3 px-6 py-6 border-b border-gray-200/50">
    <div
      class="flex items-center justify-center w-10 h-10 bg-gradient-to-r from-[var(--tw-primary)] to-[var(--tw-primary-light)] rounded-xl"
    >
      <app-microphone-icon [size]="20" [color]="'white'" />
    </div>
    <div>
      <h1 class="text-xl font-bold text-gray-900">Notis.nu</h1>
      <p class="text-sm text-gray-500">Capture your thoughts</p>
    </div>
  </div>

  <!-- Content -->
  <div class="flex-1 flex flex-col px-4 py-6 overflow-hidden">
    <!-- Create Note Button -->
    <button
      (click)="onNewNote()"
      class="flex items-center gap-3 w-full px-4 py-3 mb-6 text-white bg-gradient-to-r from-[var(--tw-primary)] to-[var(--tw-primary-light)] rounded-xl hover:shadow-lg transition-all duration-200 group"
    >
      <app-plus-icon
        [size]="20"
        [color]="'white'"
        class="group-hover:rotate-90 transition-transform duration-200"
      />
      <span class="font-medium">New Note</span>
    </button>

    <!-- Main Navigation -->
    <div class="space-y-2 mb-6">
      <a
        routerLink="/"
        routerLinkActive="text-[var(--tw-primary)] bg-[var(--tw-primary-accent-bg)] shadow-sm"
        [routerLinkActiveOptions]="{ exact: true }"
        class="flex items-center gap-3 w-full px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:text-[var(--tw-primary)] hover:bg-gray-50"
      >
        <app-home-icon [size]="20" [color]="'currentColor'" />
        <span class="font-medium">Home</span>
      </a>

      <a
        routerLink="/notes"
        routerLinkActive="text-[var(--tw-primary)] bg-[var(--tw-primary-accent-bg)] shadow-sm"
        [routerLinkActiveOptions]="{ exact: true }"
        class="flex items-center gap-3 w-full px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:text-[var(--tw-primary)] hover:bg-gray-50"
      >
        <app-file-text-icon [size]="20" [color]="'currentColor'" />
        <span class="font-medium">All Notes</span>
      </a>
    </div>

    <!-- Tags Section -->
    @if (hasTags()) {
    <div class="mb-6">
      <button
        (click)="onTagsToggle()"
        class="flex items-center justify-between w-full px-4 py-3 text-gray-700 hover:text-[var(--tw-primary)] hover:bg-gray-50 rounded-xl transition-all duration-200"
        [attr.aria-expanded]="isTagsExpanded()"
        aria-controls="tags-list"
      >
        <div class="flex items-center gap-3">
          <app-tag-icon [size]="20" [color]="'currentColor'" />
          <span class="font-medium">Tags</span>
          @if (selectedTags().length > 0) {
          <span
            class="text-xs bg-[var(--tw-primary-accent-bg)] text-[var(--tw-primary)] px-2 py-1 rounded-full"
          >
            {{ selectedTags().length }} selected
          </span>
          }
        </div>
        @if (isTagsExpanded()) {
        <app-icon-chevron
          [size]="16"
          [color]="'currentColor'"
          [orientation]="'down'"
          class="transition-transform duration-300"
        />
        } @else {
        <app-icon-chevron
          [size]="16"
          [color]="'currentColor'"
          [orientation]="'right'"
          class="transition-transform duration-300"
        />
        }
      </button>

      <div
        id="tags-list"
        class="overflow-hidden transition-all duration-300 ease-in-out"
        [class]="
          isTagsExpanded() ? 'max-h-80 opacity-100' : 'max-h-0 opacity-0'
        "
      >
        <div class="px-4 py-2">
          @if (availableTags().length === 0) {
          <p class="text-sm text-gray-500 py-4 text-center">
            No tags available
          </p>
          } @else {
          <div class="max-h-60 overflow-y-auto space-y-2 mb-4">
            @for (tag of availableTags(); track tag) {
            <label
              class="flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors duration-200"
            >
              <input
                type="checkbox"
                [checked]="isTagSelected(tag)"
                (change)="onTagToggle(tag)"
                class="w-4 h-4 text-[var(--tw-primary)] border-gray-300 rounded focus:ring-[var(--tw-primary)] focus:ring-2"
                [attr.aria-label]="'Filter by ' + tag + ' tag'"
              />
              <span
                class="flex-1 px-3 py-1 rounded-full text-sm transition-all duration-200"
                [class]="
                  isTagSelected(tag)
                    ? 'bg-slate-200 text-slate-800 font-medium'
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                "
              >
                #{{ tag }}
              </span>
            </label>
            }
          </div>

          @if (selectedTags().length > 0) {
          <button
            (click)="onClearFilters()"
            class="w-full px-3 py-2 text-sm text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors duration-200 flex items-center justify-center gap-2"
            aria-label="Clear all tag filters"
          >
            <app-x-icon [size]="16" [color]="'currentColor'" />
            Clear Filters
          </button>
          } }
        </div>
      </div>
    </div>
    }

    <!-- Bottom Navigation -->
    <div class="mt-auto space-y-2">
      <a
        routerLink="/settings"
        routerLinkActive="text-[var(--tw-primary)] bg-[var(--tw-primary-accent-bg)] shadow-sm"
        [routerLinkActiveOptions]="{ exact: true }"
        class="flex items-center gap-3 w-full px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:text-[var(--tw-primary)] hover:bg-gray-50"
      >
        <app-settings-icon [size]="20" [color]="'currentColor'" />
        <span class="font-medium">Settings</span>
      </a>
    </div>
  </div>
</aside>
